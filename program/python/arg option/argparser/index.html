<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>argparse详解 - My Docs</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">My Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../../File%20read%20and%20write/%E5%A4%9A%E8%A1%8C%E8%BE%93%E5%85%A5/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../getopt/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#argparse" class="nav-link">argparse详解</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="argparse">argparse详解</h1>
<p>https://zhuanlan.zhihu.com/p/539331146</p>
<p>https://docs.python.org/3/library/argparse.html   官网</p>
<h3 id="1-argparse">1. argparse简介</h3>
<p>argparse 模块是 Python 内置的用于命令项选项与参数解析的模块，argparse 模块可以让人轻松编写用户友好的命令行接口，能够帮助程序员为模型定义参数。</p>
<h5 id="11-argparse">1.1 argparse定义四个步骤</h5>
<ul>
<li>导入argparse包 ——import argparse</li>
<li>创建一个命令行解析器对象 ——创建 ArgumentParser() 对象</li>
<li>给解析器添加命令行参数 ——调用add_argument() 方法添加参数</li>
<li>解析命令行的参数 ——使用 parse_args() 解析添加的参数</li>
</ul>
<h5 id="12">1.2 举个栗子</h5>
<pre><code class="language-python"># 导入库
import argparse

# 1. 定义命令行解析器对象
parser = argparse.ArgumentParser(description='Demo of argparse')

# 2. 添加命令行参数
parser.add_argument('--epochs', type=int, default=30)
parser.add_argument('--batch', type=int, default=4)

# 3. 从命令行中结构化解析参数
args = parser.parse_args()
print(args)
# Namespace(batch=4, epochs=30)


epochs = args.epochs
batch = args.batch
print('show {}  {}'.format(epochs, batch))
# show 30 4
</code></pre>
<p>用大白话对上面代码进行解读，首先我们导入argparse这个包，然后包中的ArgumentParser类生成一个parser对象（其中的description对参数解析器的作用进行描述）</p>
<p>当我们在命令行显示帮助信息的时候会看到description描述的信息。例如:</p>
<pre><code class="language-python">python3 ./test.py -h
usage: test.py [-h] [--epochs EPOCHS] [--batch BATCH]

Demo of argparse

optional arguments:
  -h, --help       show this help message and exit
  --epochs EPOCHS
  --batch BATCH

</code></pre>
<p>下面是参数的使用方法</p>
<pre><code class="language-python">python fun_test.py --epochs 30 --batch 4
</code></pre>
<h3 id="2">2. 参数详解</h3>
<h5 id="21-add_argument">2.1 add_argument() 方法</h5>
<p>（1）添加命令行参数</p>
<p>给一个 ArgumentParser 添加程序参数信息，是通过调用 add_argument() 方法完成的。通常，这些调用指定 ArgumentParser 如何获取命令行字符串并将其转换为对象。这些信息在 parse_args() 调用时被存储在ArgumentParser实例化对象中，以供后续使用。add_argument() 方法定义如何解析命令行参数的呢？</p>
<p>（2）add_argument() 方法定义如何解析命令行参数</p>
<pre><code class="language-text">parser.add_argument(name or flags...[, action][, nargs][, const][, default][, type][,choices][, required][, help][, metavar][, dest])
</code></pre>
<p>每个参数解释如下:</p>
<ul>
<li><strong>name or flags:</strong> 普通参数或flag参数选项参数的名称或标签，例如 epochs 或者 -e, --epochs。Flag参数不需要指定参数值，只需要带有参数名即可。</li>
<li><strong>action:</strong> 命令行遇到flags参数时的动作。有两个常见的动作，store_true：设定flag参数为true；store_false：设定flag参数为False。注意：如果直接运行程序，默认不读取该变量，要使用必须要进行传参，例如：python <a href="https://link.zhihu.com/?target=http%3A//try.py">try.py</a> --epochs</li>
<li>nargs: 应该读取的命令行参数个数，可以是具体的数字，或者是?号，当不指定值时对于 Positional argument 使用 default，对于 Optional argument 使用 const；或者是 * 号，表示 0 或多个参数；或者是 + 号表示 1 或多个参数。</li>
<li><strong>default:</strong> 不指定参数时该参数的默认值。</li>
<li><strong>type:</strong> 命令行参数应该被转换成的数据类型。</li>
<li>required: 是否为必选参数或可选参数。</li>
<li><strong>help:</strong> 参数的帮助信息。</li>
<li>metavar： 在 usage 说明中的参数名称，对于必选参数，默认就是参数名称，对于可选参数默认是全大写的参数名称。</li>
<li>dest： 解析后的参数名称，默认情况下，对于可选参数选取最长的名称，中划线转换为下划线.</li>
<li>choices： 参数可允许的值的一个容器。</li>
<li>const： action 和 nargs 所需要的常量值。</li>
<li>store_const：表示赋值为const；</li>
<li>append：将遇到的值存储成列表，也就是如果参数重复则会保存多个值;</li>
<li>append_const：将参数规范中定义的一个值保存到一个列表；</li>
<li>count：存储遇到的次数；此外，也可以继承 argparse.Action 自定义参数解析；</li>
</ul>
<h5 id="22-parse_args">2.2 解析命令行的参数：parse_args()</h5>
<p>ArgumentParser对象通过 parse_args() 方法解析命令行的参数。它将检查命令行中每个参数，转换为适当的数据类型，然后调用相应的操作，并把参数结构化后存放在对象args中。</p>
<pre><code class="language-text">args = parser.parse_args()
</code></pre>
<p>在脚本中，通常 parse_args() 会被不带参数调用，而 ArgumentParser 将自动从 sys.argv 中确定命令行参数。</p>
<p>示例</p>
<pre><code class="language-python">import argparse

# 1.创建解释器
parser = argparse.ArgumentParser(description=&quot;可写可不写，只是在命令行参数出现错误的时候，随着错误信息打印出来。&quot;)
# 2.添加需要的参数
parser.add_argument('-gf', '--girlfriend', choices=['jingjing', 'lihuan'], type = str)
# 参数解释
# -gf 代表短选项，在命令行输入-gf和--girlfriend的效果是一样的，作用是简化参数输入
#--girlfriend 代表完整的参数名称，可以尽量做到让人见名知意，需要注意的是如果想通过解析后的参数取出该值，必须使用带--的名称
# choices 代表输入参数的只能是这个choices里面的内容，其他内容则会保错
parser.add_argument('--house', type=int, default=0)
# 参数解释
# --house 代表参数名称
# type  代表输入的参数类型，从命令行输入的参数，默认是字符串类型
# default 代表如果该参数不输入，则会默认使用该值
parser.add_argument('food')
# 参数解释
# 该种方式则要求必须输入该参数
# 输入该参数不需要指定参数名称，指定反而报错，解释器会自动将输入的参数赋值给food

# 3.进行参数解析
args = parser.parse_args() 
print('------args---------',args)
print('-------gf-------', args.girlfriend)
</code></pre>
<p>使用</p>
<pre><code class="language-python">python gf.py potato ，这种方式会将potato赋值给food
python gf.py -gf jingjing tomato，该种方式会将jingjing赋值给girlfriend，tomato赋值给food
python gf.py --house 2 chicken，该种方式会将house赋值为2，food赋值为chicken
</code></pre>
<pre><code class="language-python">def deal_args():
  # 1.创建解释器
  parser = argparse.ArgumentParser(description=&quot;cmd line error.&quot;)
  # 2.添加需要的参数
  parser.add_argument('-p', '--password', type = str)
  args = parser.parse_args()
  print(args)
  return args


def main():
  deal_args()
  print(args.password)
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js"></script>
        <script src="../../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
